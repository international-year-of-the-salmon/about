---
title: "Published Data"
---

```{r setup, include = FALSE}
knitr::opts_chunk$set(include = FALSE, echo = FALSE, warning = FALSE, message = FALSE, error = FALSE)
library(ckanr)
library(tidyverse)
```

```{r, include = FALSE}
ckanr_setup(url = "http://iys.hakai.org", key = "d386ae49-3756-4c39-945f-1b428b0fc130")

pkgs <- package_list_current(as = "table", limit = 2000)
resources <- pkgs$resources
names(pkgs)

subset <- pkgs %>% 
  select(title, id, `metadata-point-of-contact`, `unique-resource-identifier-full`) %>% 
  filter(`unique-resource-identifier-full` != "") 
  
bits <- unlist(strsplit(subset$`unique-resource-identifier-full`, " "))

bites <- bits[nchar(bits) > 20]
partial_dois <- str_match(bites, "10\\s*(.*?)\\s*\"")
dois <- paste0("https://doi.org/10", partial_dois[,2])
dois

subset <- subset %>% 
  mutate(dois = dois) %>% 
  select("Dataset Title" = title, "Digital Object Identifier" = dois, -`unique-resource-identifier-full`, -id, -`metadata-point-of-contact`)
```

```{r, include = TRUE}
knitr::kable(subset, caption = "IYS datasets that have been published")
```



